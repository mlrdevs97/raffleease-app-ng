<div class="flex flex-col">
    @if (successMessage()) {
    <div class="mb-4 w-full rounded-md bg-green-50 p-3">
        <p class="text-green-700 text-sm">{{ successMessage() }}</p>
    </div>
    }

    @if (errorMessage()) {
    <div class="mb-4 w-full rounded-md bg-red-50 p-3">
        <p class="text-red-700 text-sm">{{ errorMessage() }}</p>
    </div>
    }

    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 sm:gap-0">
        <div class="flex flex-col sm:flex-row gap-4 sm:gap-6 w-full">
            <!-- Profile Image Placeholder -->
            <div class="w-full sm:w-32 shrink-0">
                <div class="aspect-3/2 rounded-lg shadow-sm bg-gray-100 flex items-center justify-center w-full h-auto">
                    <img src="/assets/profile-placeholder.png" alt="Profile Image"
                        class="w-full h-full object-cover rounded-lg">
                </div>
            </div>

            <!-- User Information -->
            <div class="px-2 space-y-2 flex-1">
                <!-- Full Name with Status Label -->
                <div class="flex items-center gap-3">
                    <div class="text-base font-semibold leading-6 text-zinc-950">
                        {{ getFullName() }}
                    </div>
                    <!-- Account Status Label moved here -->
                    @if (user.isEnabled) {
                    <span
                        class="inline-flex items-center rounded-full px-2 py-1 text-xs font-medium bg-green-100 text-green-800 ring-1 ring-inset ring-green-600/20">
                        Active
                    </span>
                    } @else {
                    <span
                        class="inline-flex items-center rounded-full px-2 py-1 text-xs font-medium bg-red-100 text-red-800 ring-1 ring-inset ring-red-600/20">
                        Disabled
                    </span>
                    }
                </div>

                <!-- Username -->
                <div class="flex items-center gap-2 text-xs/6 text-zinc-500">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-zinc-500" viewBox="0 0 375 374.999991"
                        preserveAspectRatio="xMidYMid meet">
                        <defs />
                        <path fill="currentColor"
                            d="M 284.714844 98.886719 C 284.714844 100.496094 284.675781 102.101562 284.59375 103.707031 C 284.515625 105.3125 284.398438 106.917969 284.242188 108.515625 C 284.082031 110.117188 283.886719 111.710938 283.648438 113.300781 C 283.414062 114.890625 283.140625 116.476562 282.824219 118.050781 C 282.511719 119.628906 282.160156 121.199219 281.769531 122.757812 C 281.378906 124.316406 280.949219 125.867188 280.484375 127.402344 C 280.015625 128.941406 279.511719 130.46875 278.972656 131.980469 C 278.429688 133.496094 277.851562 134.996094 277.238281 136.480469 C 276.621094 137.964844 275.96875 139.433594 275.28125 140.890625 C 274.59375 142.34375 273.871094 143.777344 273.113281 145.195312 C 272.355469 146.613281 271.566406 148.011719 270.738281 149.390625 C 269.914062 150.769531 269.050781 152.128906 268.160156 153.464844 C 267.265625 154.800781 266.339844 156.113281 265.382812 157.40625 C 264.425781 158.699219 263.4375 159.964844 262.417969 161.207031 C 261.398438 162.449219 260.347656 163.667969 259.269531 164.859375 C 258.1875 166.050781 257.082031 167.214844 255.945312 168.351562 C 254.808594 169.488281 253.644531 170.59375 252.453125 171.675781 C 251.261719 172.753906 250.042969 173.804688 248.800781 174.824219 C 247.558594 175.84375 246.292969 176.832031 245 177.789062 C 243.710938 178.75 242.394531 179.675781 241.058594 180.566406 C 239.722656 181.460938 238.363281 182.320312 236.984375 183.148438 C 235.605469 183.972656 234.207031 184.765625 232.792969 185.523438 C 231.375 186.28125 229.9375 187.003906 228.484375 187.691406 C 227.03125 188.378906 225.5625 189.03125 224.078125 189.644531 C 222.59375 190.261719 221.09375 190.839844 219.578125 191.378906 C 218.066406 191.921875 216.539062 192.425781 215 192.894531 C 213.464844 193.359375 211.914062 193.789062 210.355469 194.179688 C 208.796875 194.570312 207.226562 194.921875 205.652344 195.234375 C 204.074219 195.550781 202.492188 195.824219 200.902344 196.058594 C 199.3125 196.296875 197.714844 196.492188 196.117188 196.648438 C 194.515625 196.808594 192.914062 196.925781 191.308594 197.003906 C 189.703125 197.082031 188.097656 197.121094 186.488281 197.121094 C 184.878906 197.121094 183.273438 197.082031 181.667969 197.003906 C 180.0625 196.925781 178.460938 196.808594 176.859375 196.648438 C 175.261719 196.492188 173.664062 196.296875 172.074219 196.058594 C 170.484375 195.824219 168.902344 195.550781 167.324219 195.234375 C 165.75 194.921875 164.179688 194.570312 162.621094 194.179688 C 161.0625 193.789062 159.511719 193.359375 157.976562 192.894531 C 156.4375 192.425781 154.910156 191.921875 153.398438 191.378906 C 151.882812 190.839844 150.382812 190.261719 148.898438 189.644531 C 147.414062 189.03125 145.945312 188.378906 144.492188 187.691406 C 143.039062 187.003906 141.601562 186.28125 140.183594 185.523438 C 138.765625 184.765625 137.371094 183.972656 135.992188 183.148438 C 134.613281 182.320312 133.253906 181.460938 131.917969 180.566406 C 130.582031 179.675781 129.265625 178.75 127.976562 177.789062 C 126.683594 176.832031 125.417969 175.84375 124.175781 174.824219 C 122.933594 173.804688 121.714844 172.753906 120.523438 171.675781 C 119.332031 170.59375 118.167969 169.488281 117.03125 168.351562 C 115.894531 167.214844 114.789062 166.050781 113.707031 164.859375 C 112.628906 163.667969 111.578125 162.449219 110.558594 161.207031 C 109.539062 159.964844 108.550781 158.699219 107.59375 157.40625 C 106.636719 156.113281 105.710938 154.800781 104.816406 153.464844 C 103.925781 152.128906 103.0625 150.769531 102.238281 149.390625 C 101.410156 148.011719 100.621094 146.613281 99.863281 145.195312 C 99.105469 143.777344 98.382812 142.34375 97.695312 140.890625 C 97.007812 139.433594 96.355469 137.964844 95.738281 136.480469 C 95.125 134.996094 94.546875 133.496094 94.003906 131.980469 C 93.464844 130.46875 92.960938 128.941406 92.492188 127.402344 C 92.027344 125.867188 91.597656 124.316406 91.207031 122.757812 C 90.816406 121.199219 90.464844 119.628906 90.152344 118.050781 C 89.835938 116.476562 89.5625 114.890625 89.328125 113.300781 C 89.089844 111.710938 88.894531 110.117188 88.734375 108.515625 C 88.578125 106.917969 88.460938 105.3125 88.382812 103.707031 C 88.300781 102.101562 88.261719 100.496094 88.261719 98.886719 C 88.261719 97.28125 88.300781 95.671875 88.382812 94.066406 C 88.460938 92.460938 88.578125 90.859375 88.734375 89.257812 C 88.894531 87.660156 89.089844 86.0625 89.328125 84.472656 C 89.5625 82.882812 89.835938 81.300781 90.152344 79.722656 C 90.464844 78.148438 90.816406 76.578125 91.207031 75.019531 C 91.597656 73.460938 92.027344 71.910156 92.492188 70.371094 C 92.960938 68.832031 93.464844 67.308594 94.003906 65.792969 C 94.546875 64.28125 95.125 62.78125 95.738281 61.296875 C 96.355469 59.808594 97.007812 58.339844 97.695312 56.886719 C 98.382812 55.433594 99.105469 54 99.863281 52.582031 C 100.621094 51.164062 101.410156 49.765625 102.238281 48.386719 C 103.0625 47.007812 103.925781 45.648438 104.816406 44.3125 C 105.710938 42.976562 106.636719 41.660156 107.59375 40.371094 C 108.550781 39.078125 109.539062 37.8125 110.558594 36.570312 C 111.578125 35.324219 112.628906 34.109375 113.707031 32.917969 C 114.789062 31.726562 115.894531 30.5625 117.03125 29.425781 C 118.167969 28.289062 119.332031 27.179688 120.523438 26.101562 C 121.714844 25.019531 122.933594 23.972656 124.175781 22.953125 C 125.417969 21.933594 126.683594 20.941406 127.976562 19.984375 C 129.265625 19.027344 130.582031 18.101562 131.917969 17.207031 C 133.253906 16.316406 134.613281 15.457031 135.992188 14.628906 C 137.371094 13.804688 138.765625 13.011719 140.183594 12.253906 C 141.601562 11.496094 143.039062 10.773438 144.492188 10.085938 C 145.945312 9.398438 147.414062 8.746094 148.898438 8.132812 C 150.382812 7.515625 151.882812 6.9375 153.398438 6.394531 C 154.910156 5.855469 156.4375 5.351562 157.976562 4.882812 C 159.511719 4.417969 161.0625 3.988281 162.621094 3.597656 C 164.179688 3.207031 165.75 2.855469 167.324219 2.539062 C 168.902344 2.226562 170.484375 1.953125 172.074219 1.714844 C 173.664062 1.480469 175.261719 1.285156 176.859375 1.125 C 178.460938 0.96875 180.0625 0.851562 181.667969 0.773438 C 183.273438 0.691406 184.878906 0.652344 186.488281 0.652344 C 188.097656 0.652344 189.703125 0.691406 191.308594 0.773438 C 192.914062 0.851562 194.515625 0.96875 196.117188 1.125 C 197.714844 1.285156 199.3125 1.480469 200.902344 1.714844 C 202.492188 1.953125 204.074219 2.226562 205.652344 2.539062 C 207.226562 2.855469 208.796875 3.207031 210.355469 3.597656 C 211.914062 3.988281 213.464844 4.417969 215 4.882812 C 216.539062 5.351562 218.066406 5.855469 219.578125 6.394531 C 221.09375 6.9375 222.59375 7.515625 224.078125 8.132812 C 225.5625 8.746094 227.03125 9.398438 228.484375 10.085938 C 229.9375 10.773438 231.375 11.496094 232.792969 12.253906 C 234.207031 13.011719 235.605469 13.804688 236.984375 14.628906 C 238.363281 15.457031 239.722656 16.316406 241.058594 17.207031 C 242.394531 18.101562 243.710938 19.027344 245 19.984375 C 246.292969 20.941406 247.558594 21.933594 248.800781 22.953125 C 250.042969 23.972656 251.261719 25.019531 252.453125 26.101562 C 253.644531 27.179688 254.808594 28.289062 255.945312 29.425781 C 257.082031 30.5625 258.1875 31.726562 259.269531 32.917969 C 260.347656 34.109375 261.398438 35.324219 262.417969 36.570312 C 263.4375 37.8125 264.425781 39.078125 265.382812 40.371094 C 266.339844 41.660156 267.265625 42.976562 268.160156 44.3125 C 269.050781 45.648438 269.914062 47.007812 270.738281 48.386719 C 271.566406 49.765625 272.355469 51.164062 273.113281 52.582031 C 273.871094 54 274.59375 55.433594 275.28125 56.886719 C 275.96875 58.339844 276.621094 59.808594 277.238281 61.296875 C 277.851562 62.78125 278.429688 64.28125 278.972656 65.792969 C 279.511719 67.308594 280.015625 68.832031 280.484375 70.371094 C 280.949219 71.910156 281.378906 73.460938 281.769531 75.019531 C 282.160156 76.578125 282.511719 78.148438 282.824219 79.722656 C 283.140625 81.300781 283.414062 82.882812 283.648438 84.472656 C 283.886719 86.0625 284.082031 87.660156 284.242188 89.257812 C 284.398438 90.859375 284.515625 92.460938 284.59375 94.066406 C 284.675781 95.671875 284.714844 97.28125 284.714844 98.886719 Z M 284.714844 98.886719 " />
                        <path fill="currentColor"
                            d="M 54.480469 374.578125 L 318.496094 374.578125 C 319.453125 374.566406 320.410156 374.527344 321.367188 374.460938 C 322.320312 374.394531 323.273438 374.296875 324.222656 374.171875 C 325.171875 374.046875 326.117188 373.894531 327.058594 373.710938 C 328 373.527344 328.933594 373.320312 329.859375 373.082031 C 330.789062 372.84375 331.707031 372.578125 332.621094 372.285156 C 333.53125 371.992188 334.433594 371.671875 335.328125 371.324219 C 336.21875 370.980469 337.101562 370.605469 337.972656 370.207031 C 338.84375 369.804688 339.699219 369.382812 340.542969 368.929688 C 341.390625 368.480469 342.21875 368.003906 343.035156 367.5 C 343.851562 367 344.652344 366.476562 345.4375 365.925781 C 346.222656 365.378906 346.992188 364.804688 347.742188 364.210938 C 348.492188 363.617188 349.222656 363 349.9375 362.359375 C 350.652344 361.722656 351.34375 361.0625 352.019531 360.382812 C 352.691406 359.699219 353.347656 359 353.980469 358.28125 C 354.609375 357.5625 355.222656 356.824219 355.808594 356.066406 C 356.398438 355.3125 356.960938 354.539062 357.503906 353.75 C 358.042969 352.957031 358.5625 352.152344 359.054688 351.332031 C 359.550781 350.511719 360.015625 349.675781 360.460938 348.828125 C 360.902344 347.976562 361.320312 347.117188 361.714844 346.242188 C 362.105469 345.367188 362.46875 344.484375 362.808594 343.585938 C 363.148438 342.691406 363.460938 341.785156 363.742188 340.871094 C 364.027344 339.957031 364.285156 339.035156 364.515625 338.105469 C 364.742188 337.175781 364.945312 336.238281 365.117188 335.296875 C 365.289062 334.355469 365.433594 333.40625 365.550781 332.457031 C 365.667969 331.507812 365.753906 330.554688 365.816406 329.597656 C 365.875 328.640625 365.90625 327.683594 365.90625 326.726562 C 365.910156 325.769531 365.882812 324.8125 365.824219 323.855469 C 365.769531 322.898438 365.6875 321.945312 365.574219 320.992188 C 365.460938 320.042969 365.320312 319.097656 365.152344 318.152344 C 364.980469 317.210938 364.785156 316.273438 364.558594 315.34375 C 364.332031 314.410156 364.082031 313.488281 363.800781 312.574219 C 363.519531 311.65625 363.210938 310.75 362.875 309.851562 C 361.515625 306.410156 360.027344 303.027344 358.414062 299.695312 C 356.800781 296.363281 355.0625 293.101562 353.203125 289.898438 C 351.34375 286.699219 349.371094 283.574219 347.277344 280.523438 C 345.183594 277.46875 342.980469 274.5 340.664062 271.613281 C 338.347656 268.726562 335.929688 265.929688 333.40625 263.222656 C 330.878906 260.519531 328.257812 257.910156 325.539062 255.402344 C 322.816406 252.894531 320.007812 250.488281 317.105469 248.191406 C 314.207031 245.890625 311.226562 243.703125 308.160156 241.628906 C 305.097656 239.554688 301.960938 237.597656 298.75 235.757812 C 295.539062 233.914062 292.265625 232.199219 288.925781 230.605469 C 285.585938 229.007812 282.191406 227.539062 278.742188 226.199219 C 275.292969 224.859375 271.800781 223.648438 268.257812 222.570312 C 264.71875 221.492188 261.144531 220.546875 257.535156 219.738281 C 253.921875 218.925781 250.289062 218.25 246.625 217.710938 C 242.964844 217.175781 239.289062 216.773438 235.597656 216.511719 C 231.90625 216.246094 228.210938 216.121094 224.511719 216.136719 L 148.464844 216.136719 C 144.769531 216.136719 141.074219 216.273438 137.386719 216.546875 C 133.699219 216.820312 130.027344 217.230469 126.371094 217.777344 C 122.714844 218.328125 119.082031 219.011719 115.476562 219.828125 C 111.871094 220.648438 108.300781 221.597656 104.765625 222.683594 C 101.230469 223.765625 97.738281 224.980469 94.292969 226.324219 C 90.847656 227.667969 87.460938 229.140625 84.125 230.734375 C 80.789062 232.332031 77.515625 234.050781 74.308594 235.890625 C 71.101562 237.730469 67.96875 239.6875 64.90625 241.761719 C 61.84375 243.835938 58.863281 246.019531 55.964844 248.316406 C 53.066406 250.613281 50.257812 253.011719 47.535156 255.515625 C 44.816406 258.023438 42.191406 260.625 39.667969 263.324219 C 37.140625 266.023438 34.71875 268.816406 32.398438 271.695312 C 30.078125 274.578125 27.871094 277.539062 25.773438 280.585938 C 23.675781 283.632812 21.695312 286.75 19.828125 289.941406 C 17.960938 293.136719 16.21875 296.394531 14.59375 299.714844 C 12.972656 303.039062 11.472656 306.417969 10.101562 309.851562 C 9.765625 310.75 9.457031 311.65625 9.179688 312.570312 C 8.898438 313.488281 8.644531 314.410156 8.417969 315.339844 C 8.191406 316.273438 7.996094 317.210938 7.824219 318.152344 C 7.65625 319.09375 7.515625 320.042969 7.402344 320.992188 C 7.289062 321.945312 7.203125 322.898438 7.148438 323.855469 C 7.09375 324.8125 7.066406 325.769531 7.066406 326.726562 C 7.070312 327.683594 7.101562 328.640625 7.160156 329.597656 C 7.21875 330.554688 7.304688 331.507812 7.421875 332.457031 C 7.539062 333.40625 7.683594 334.355469 7.855469 335.296875 C 8.027344 336.238281 8.230469 337.175781 8.457031 338.105469 C 8.6875 339.035156 8.945312 339.957031 9.230469 340.871094 C 9.511719 341.789062 9.824219 342.691406 10.164062 343.589844 C 10.5 344.484375 10.867188 345.371094 11.257812 346.246094 C 11.648438 347.117188 12.066406 347.980469 12.511719 348.828125 C 12.953125 349.679688 13.421875 350.511719 13.917969 351.335938 C 14.410156 352.15625 14.925781 352.960938 15.46875 353.75 C 16.011719 354.542969 16.574219 355.3125 17.164062 356.070312 C 17.75 356.828125 18.363281 357.566406 18.992188 358.285156 C 19.625 359.003906 20.277344 359.703125 20.953125 360.382812 C 21.628906 361.066406 22.320312 361.722656 23.035156 362.363281 C 23.75 363.003906 24.480469 363.617188 25.230469 364.214844 C 25.984375 364.808594 26.75 365.378906 27.535156 365.929688 C 28.320312 366.480469 29.121094 367.003906 29.9375 367.503906 C 30.753906 368.003906 31.585938 368.480469 32.429688 368.933594 C 33.273438 369.382812 34.132812 369.808594 35.003906 370.207031 C 35.875 370.609375 36.753906 370.980469 37.648438 371.328125 C 38.539062 371.675781 39.441406 371.996094 40.355469 372.289062 C 41.265625 372.582031 42.1875 372.847656 43.113281 373.082031 C 44.042969 373.320312 44.976562 373.53125 45.917969 373.710938 C 46.859375 373.894531 47.804688 374.046875 48.753906 374.171875 C 49.703125 374.296875 50.65625 374.394531 51.609375 374.460938 C 52.566406 374.527344 53.523438 374.570312 54.480469 374.578125 Z M 54.480469 374.578125 " />
                        <path
                            d="M 0.0625 -0.0625 C 0.0625 -0.09375 0.0664062 -0.113281 0.078125 -0.125 C 0.0859375 -0.144531 0.109375 -0.15625 0.140625 -0.15625 C 0.171875 -0.15625 0.191406 -0.144531 0.203125 -0.125 C 0.222656 -0.113281 0.234375 -0.09375 0.234375 -0.0625 C 0.234375 -0.0390625 0.222656 -0.0195312 0.203125 0 C 0.191406 0.0078125 0.171875 0.015625 0.140625 0.015625 C 0.117188 0.015625 0.0976562 0.0078125 0.078125 0 C 0.0664062 -0.0195312 0.0625 -0.0390625 0.0625 -0.0625 Z M 0.0625 -0.0625 " />
                    </svg>
                    {{ user.userName }}
                </div>

                <!-- Email -->
                <div class="flex items-center gap-2 text-xs/6 text-zinc-500">
                    <svg class="h-4 w-4 fill-zinc-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 469.2 469.2">
                        <path
                            d="M22.202,77.023C25.888,75.657,29.832,74.8,34,74.8h401.2c4.168,0,8.112,0.857,11.798,2.224L267.24,246.364 c-18.299,17.251-46.975,17.251-65.28,0L22.202,77.023z M464.188,377.944c3.114-5.135,5.012-11.098,5.012-17.544V108.8 c0-4.569-0.932-8.915-2.57-12.899L298.411,254.367L464.188,377.944z M283.2,268.464c-13.961,11.961-31.253,18.027-48.6,18.027 c-17.347,0-34.64-6.06-48.6-18.027L20.692,391.687c4.094,1.741,8.582,2.714,13.308,2.714h401.2c4.726,0,9.214-0.973,13.308-2.714 L283.2,268.464z M2.571,95.9C0.932,99.885,0,104.23,0,108.8V360.4c0,6.446,1.897,12.409,5.012,17.544l165.777-123.577L2.571,95.9z">
                        </path>
                    </svg>
                    {{ user.email }}
                </div>

                <!-- Phone Number -->
                <div class="flex items-center gap-2 text-xs/6 text-zinc-500">
                    <svg viewBox="0 0 24 24" class="w-4 h-4 fill-zinc-500" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M16.5562 12.9062L16.1007 13.359C16.1007 13.359 15.0181 14.4355 12.0631 11.4972C9.10812 8.55901 10.1907 7.48257 10.1907 7.48257L10.4775 7.19738C11.1841 6.49484 11.2507 5.36691 10.6342 4.54348L9.37326 2.85908C8.61028 1.83992 7.13596 1.70529 6.26145 2.57483L4.69185 4.13552C4.25823 4.56668 3.96765 5.12559 4.00289 5.74561C4.09304 7.33182 4.81071 10.7447 8.81536 14.7266C13.0621 18.9492 17.0468 19.117 18.6763 18.9651C19.1917 18.9171 19.6399 18.6546 20.0011 18.2954L21.4217 16.883C22.3806 15.9295 22.1102 14.2949 20.8833 13.628L18.9728 12.5894C18.1672 12.1515 17.1858 12.2801 16.5562 12.9062Z"></path>
                    </svg>
                    {{ getPhoneNumber() }}
                </div>
            </div>
        </div>

        <!-- Right: Role Dropdown + Enable/Disable Button -->
        <div class="flex flex-col sm:flex-row items-start sm:items-center gap-4">
            <!-- Role Dropdown (replaces previous status section) -->
            <div class="flex flex-col gap-2 min-w-[140px]">
                <app-dropdown-select [options]="roleOptions" [placeholder]="getCurrentRoleForDropdown()"
                    [displayAllOption]="false" [formControl]="roleControl" class="text-sm">
                </app-dropdown-select>
            </div>

            <!-- Enable/Disable Button -->
            <div class="flex-shrink-0">
                <app-button [variant]="getStatusButtonVariant()" [loading]="isUpdatingStatus()"
                    [loadingText]="getStatusButtonText()" [disabled]="isUpdatingStatus()" size="sm"
                    (clicked)="toggleUserStatus()">
                    {{ getStatusButtonText() }}
                </app-button>
            </div>
        </div>
    </div>

    <!-- Confirmation Dialog -->
    <app-confirmation-dialog [isOpen]="showConfirmDialog" [data]="confirmDialogData" [isLoading]="isConfirmationLoading"
        (confirmed)="onConfirmRoleUpdate()" (cancelled)="onCancelRoleUpdate()">
    </app-confirmation-dialog>
</div>